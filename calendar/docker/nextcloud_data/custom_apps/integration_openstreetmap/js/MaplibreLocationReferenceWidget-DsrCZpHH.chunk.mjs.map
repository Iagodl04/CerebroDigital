{"version":3,"file":"MaplibreLocationReferenceWidget-DsrCZpHH.chunk.mjs","sources":["../src/components/map/PolygonFill.vue","../src/views/MaplibreLocationReferenceWidget.vue"],"sourcesContent":["<script>\nexport default {\n\tname: 'PolygonFill',\n\n\tcomponents: {\n\t},\n\n\tmixins: [\n\t],\n\n\tprops: {\n\t\tlayerId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tgeojson: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tmap: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tfillOutlineColor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'blue',\n\t\t},\n\t\tfillColor: {\n\t\t\ttype: String,\n\t\t\tdefault: 'lightblue',\n\t\t},\n\t\tfillOpacity: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0.5,\n\t\t},\n\t\tcontourLineWidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 4,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t\tready: false,\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tshouldFill() {\n\t\t\treturn this.geojson.type === 'Polygon'\n\t\t},\n\t},\n\n\twatch: {\n\t\tfillColor(newVal) {\n\t\t\tif (this.map.getLayer(this.layerId)) {\n\t\t\t\tthis.map.setPaintProperty(this.layerId, 'fill-color', newVal)\n\t\t\t}\n\t\t},\n\t\tfillOpacity(newVal) {\n\t\t\tif (this.map.getLayer(this.layerId)) {\n\t\t\t\tthis.map.setPaintProperty(this.layerId, 'fill-opacity', newVal)\n\t\t\t}\n\t\t},\n\t\tfillOutlineColor(newVal) {\n\t\t\tif (this.map.getLayer(this.layerId)) {\n\t\t\t\tthis.map.setPaintProperty(this.layerId, 'fill-outline-color', newVal)\n\t\t\t}\n\t\t},\n\t\tgeojson() {\n\t\t\tthis.remove()\n\t\t\tthis.init()\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.init()\n\t},\n\n\tunmounted() {\n\t\tthis.remove()\n\t},\n\n\tmethods: {\n\t\tbringToTop() {\n\t\t\tif (this.map.getLayer(this.layerId)) {\n\t\t\t\tthis.map.moveLayer(this.layerId)\n\t\t\t}\n\t\t},\n\t\tremove() {\n\t\t\tif (this.map.getLayer(this.layerId)) {\n\t\t\t\tthis.map.removeLayer(this.layerId)\n\t\t\t}\n\t\t\tif (this.map.getLayer(this.layerId + '-contour')) {\n\t\t\t\tthis.map.removeLayer(this.layerId + '-contour')\n\t\t\t}\n\t\t\tif (this.map.getSource(this.layerId)) {\n\t\t\t\tthis.map.removeSource(this.layerId)\n\t\t\t}\n\t\t},\n\t\tinit() {\n\t\t\tthis.map.addSource(this.layerId, {\n\t\t\t\ttype: 'geojson',\n\t\t\t\tlineMetrics: true,\n\t\t\t\tdata: this.geojson,\n\t\t\t})\n\t\t\tif (this.shouldFill) {\n\t\t\t\tthis.map.addLayer({\n\t\t\t\t\ttype: 'fill',\n\t\t\t\t\tsource: this.layerId,\n\t\t\t\t\tid: this.layerId,\n\t\t\t\t\tpaint: {\n\t\t\t\t\t\t'fill-color': this.fillColor,\n\t\t\t\t\t\t'fill-opacity': this.fillOpacity,\n\t\t\t\t\t\t'fill-outline-color': this.fillOutlineColor,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t}\n\t\t\tthis.map.addLayer({\n\t\t\t\ttype: 'line',\n\t\t\t\tsource: this.layerId,\n\t\t\t\tid: this.layerId + '-contour',\n\t\t\t\tpaint: {\n\t\t\t\t\t'line-color': this.fillColor,\n\t\t\t\t\t'line-width': this.contourLineWidth,\n\t\t\t\t},\n\t\t\t\tlayout: {\n\t\t\t\t\t'line-cap': 'round',\n\t\t\t\t\t'line-join': 'round',\n\t\t\t\t},\n\t\t\t})\n\n\t\t\tthis.ready = true\n\t\t},\n\t},\n\trender(h) {\n\t\treturn null\n\t},\n}\n</script>\n","<!--\n  - @copyright Copyright (c) 2023 Julien Veyssier <julien-nc@posteo.net>\n  -\n  - @author 2023 Julien Veyssier <julien-nc@posteo.net>\n  -\n  - @license GNU AGPL version 3 or any later version\n  -\n  - This program is free software: you can redistribute it and/or modify\n  - it under the terms of the GNU Affero General Public License as\n  - published by the Free Software Foundation, either version 3 of the\n  - License, or (at your option) any later version.\n  -\n  - This program is distributed in the hope that it will be useful,\n  - but WITHOUT ANY WARRANTY; without even the implied warranty of\n  - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  - GNU Affero General Public License for more details.\n  -\n  - You should have received a copy of the GNU Affero General Public License\n  - along with this program. If not, see <http://www.gnu.org/licenses/>.\n  -->\n\n<template>\n\t<div class=\"location-reference\">\n\t\t<div class=\"location\">\n\t\t\t<a v-if=\"richObject.display_name\"\n\t\t\t\tclass=\"location--link\"\n\t\t\t\t:href=\"richObject.url\"\n\t\t\t\ttarget=\"_blank\">\n\t\t\t\t<strong class=\"location--name\">\n\t\t\t\t\t{{ richObject.display_name }}\n\t\t\t\t</strong>\n\t\t\t</a>\n\t\t\t<MaplibreMap\n\t\t\t\tclass=\"location--map\"\n\t\t\t\tscrolling=\"no\"\n\t\t\t\t:bbox=\"bbox\"\n\t\t\t\t:center=\"mapCenter\"\n\t\t\t\t:zoom=\"zoom\"\n\t\t\t\t:pitch=\"pitch\"\n\t\t\t\t:bearing=\"bearing\"\n\t\t\t\t:map-style=\"style\"\n\t\t\t\t:use-terrain=\"useTerrain\"\n\t\t\t\t:use-globe=\"useGlobe\">\n\t\t\t\t<template #default=\"{ map }\">\n\t\t\t\t\t<VMarker v-if=\"markerCoords\"\n\t\t\t\t\t\t:map=\"map\"\n\t\t\t\t\t\t:lng-lat=\"markerCoords\" />\n\t\t\t\t\t<PolygonFill v-if=\"richObject.geojson\"\n\t\t\t\t\t\tlayer-id=\"target-object\"\n\t\t\t\t\t\t:geojson=\"richObject.geojson\"\n\t\t\t\t\t\t:map=\"map\"\n\t\t\t\t\t\t:fill-opacity=\"0.25\" />\n\t\t\t\t</template>\n\t\t\t</MaplibreMap>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport MaplibreMap from '../components/map/MaplibreMap.vue'\nimport VMarker from '../components/map/VMarker.vue'\nimport PolygonFill from '../components/map/PolygonFill.vue'\n\nexport default {\n\tname: 'MaplibreLocationReferenceWidget',\n\n\tcomponents: {\n\t\tPolygonFill,\n\t\tVMarker,\n\t\tMaplibreMap,\n\t},\n\n\tprops: {\n\t\trichObjectType: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\trichObject: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t\taccessible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\tdata() {\n\t\treturn {\n\t\t}\n\t},\n\n\tcomputed: {\n\t\tbbox() {\n\t\t\t// use mapCenter in priority\n\t\t\tif (this.mapCenter) {\n\t\t\t\treturn undefined\n\t\t\t}\n\t\t\tconst bb = this.richObject.boundingbox\n\t\t\treturn {\n\t\t\t\tnorth: bb[1],\n\t\t\t\tsouth: bb[0],\n\t\t\t\teast: bb[3],\n\t\t\t\twest: bb[2],\n\t\t\t}\n\t\t},\n\t\tzoom() {\n\t\t\treturn this.richObject.zoom\n\t\t},\n\t\tpitch() {\n\t\t\treturn this.richObject.pitch\n\t\t},\n\t\tbearing() {\n\t\t\treturn this.richObject.bearing\n\t\t},\n\t\tstyle() {\n\t\t\treturn this.richObject.style ?? undefined\n\t\t},\n\t\tuseTerrain() {\n\t\t\treturn this.richObject.terrain ?? undefined\n\t\t},\n\t\tuseGlobe() {\n\t\t\treturn this.richObject.globe ?? undefined\n\t\t},\n\t\tmapCenter() {\n\t\t\treturn this.richObject.map_center\n\t\t},\n\t\tmarkerCoords() {\n\t\t\treturn this.richObject.marker_coordinates\n\t\t},\n\t},\n\n\tmethods: {\n\t},\n}\n</script>\n\n<style scoped lang=\"scss\">\n.location-reference {\n\twidth: 100%;\n\twhite-space: normal;\n\n\t.location {\n\t\twidth: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\t// in case there is an absolute inside\n\t\tposition: relative;\n\n\t\t&--link {\n\t\t\tpadding: 10px;\n\t\t\t&:hover {\n\t\t\t\tcolor: #58a6ff !important;\n\t\t\t}\n\t\t}\n\n\t\t&--map {\n\t\t\twidth: 100%;\n\t\t\theight: 350px;\n\t\t}\n\t}\n}\n</style>\n"],"names":["_sfc_main","newVal","h","PolygonFill","VMarker","MaplibreMap","bb","_hoisted_1","_hoisted_2","_hoisted_4","_openBlock","_createElementBlock","_createElementVNode","$props","_toDisplayString","_createVNode","_component_MaplibreMap","$options","_withCtx","map","_createBlock","_component_VMarker","_component_PolygonFill"],"mappings":"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"}