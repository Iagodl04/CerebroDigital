(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".modal-container__content .reference-picker-modal--content{height:100%}.direction-picker-content[data-v-78ff1a7a]{width:100%;display:flex;flex-direction:column;align-items:center;padding:12px 16px}.direction-picker-content h2[data-v-78ff1a7a]{display:flex;align-items:center;margin-top:0}.direction-picker-content .header[data-v-78ff1a7a]{width:100%;display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:4px}.direction-picker-content .header .profile-select[data-v-78ff1a7a]{align-self:start;margin:0!important;width:200px!important;min-width:170px!important}.direction-picker-content .direction-map[data-v-78ff1a7a]{width:100%;height:2000px}.direction-picker-content .direction-map[data-v-78ff1a7a] .maplibregl-map{border-radius:var(--border-radius-large)}.direction-picker-content .preview-link[data-v-78ff1a7a]{margin-bottom:8px}.direction-picker-content .spacer[data-v-78ff1a7a]{flex-grow:1}.direction-picker-content .footer[data-v-78ff1a7a]{width:100%;display:flex;margin-top:8px;align-items:center;gap:8px}.direction-picker-content .footer .type-select[data-v-78ff1a7a]{width:350px;margin:0}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{A as T,s as P,g as u}from"./lastMapStateHelper-CF_pc0C2.chunk.mjs";import{_ as v}from"./index-B-L25m6y.chunk.mjs";import{c as d,o as p,a as r,b as y,t as c,m as F,r as l,e as R,d as s,p as S,w as g}from"./runtime-core.esm-bundler-CsAAUxo4.chunk.mjs";import{N as I}from"./Close-D6ngJ4t9-B_k1rgzA.chunk.mjs";import{N as x}from"./NcSelect-BUPzYWtk-DxeaHCy0.chunk.mjs";import{M as A}from"./MaplibreMap-YzUp5Hnt.chunk.mjs";import{_ as z,R as B,m as H}from"./index-Bmir7tVa.chunk.mjs";import{a as N,r as k,b as C}from"./mapUtils-m7e-c8Iy.chunk.mjs";import"./index-DZI6LgVG.chunk.mjs";import"./index-BH5XFfaS.chunk.mjs";import"./legacy-DcjXBL_t-_k54Q3Kp.chunk.mjs";import"./vue.runtime.esm-bundler-XT-a1Su5.chunk.mjs";const O={name:"HelpCircleOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},V=["aria-hidden","aria-label"],G=["fill","width","height"],W={d:"M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z"},$={key:0};function E(e,i,o,b,a,n){return p(),d("span",F(e.$attrs,{"aria-hidden":o.title?null:"true","aria-label":o.title,class:"material-design-icon help-circle-outline-icon",role:"img",onClick:i[0]||(i[0]=h=>e.$emit("click",h))}),[(p(),d("svg",{fill:o.fillColor,class:"material-design-icon__svg",width:o.size,height:o.size,viewBox:"0 0 24 24"},[r("path",W,[o.title?(p(),d("title",$,c(o.title),1)):y("",!0)])],8,G))],16,V)}const U=v(O,[["render",E]]),Z=Object.values(k),j={name:"DirectionCustomPickerElement",components:{RoutingProfilePicker:B,DirectionsPlugin:z,MaplibreMap:A,NcButton:I,NcSelect:x,ArrowRightIcon:T,HelpCircleOutlineIcon:U},props:{providerId:{type:String,required:!0},accessible:{type:Boolean,default:!1}},data(){return{selectedRoutingLinkTypeId:u()?.routingLinkType?u().routingLinkType:k.osrm_org.id,showMap:!1,lastMapState:u(),searchPlaceholder:t("integration_openstreetmap","Search with Nominatim to get an OpenStreetMap link"),linkTypesArray:Z,waypoints:null,routeDistance:null,routeDuration:null,selectedProfile:C.car,helpText:t("integration_openstreetmap","Click on the map to add waypoints. Click on waypoints to delete them. Waypoints can be dragged."),currentMapTerrain:!!u()?.terrain,currentMapGlobe:!!u()?.terrain,currentMapStyle:!!u()?.style}},computed:{profileList(){return Object.values(C)},selectedProfileId(){if(this.selectedProfile)return this.selectedProfile.id},selectedLinkType(){return k[this.selectedRoutingLinkTypeId]??null},lastCenter(){return this.lastMapState?.lat&&this.lastMapState?.lon?{lat:this.lastMapState.lat,lon:this.lastMapState.lon}:null},hint(){return this.waypoints===null||this.waypoints.length===0?t("integration_openstreetmap","Click on the map to set the start location"):this.waypoints.length===1?t("integration_openstreetmap","Click on the map to add a waypoint"):null},currentLink(){const e=N(this.waypoints,this.selectedProfile,this.selectedRoutingLinkTypeId,this.currentMapTerrain,this.currentMapGlobe,this.currentMapStyle);return console.debug("[osm] current link",e),e},formattedDuration(){return this.waypoints===null||this.waypoints.length<2||this.routeDuration===null?null:this.getFormattedDuration(this.routeDuration)},formattedDistance(){return this.waypoints===null||this.waypoints.length<2||this.routeDistance===null?null:this.getFormattedDistance(this.routeDistance)}},watch:{},mounted(){this.$nextTick(()=>{this.showMap=!0})},methods:{getFormattedDuration(e){const i=H.duration(e,"seconds");return e<3600?i.humanize():e<3600*24?i.hours()+" h "+i.minutes()+" min":i.days()+" d "+i.hours()+" h "+i.minutes()+" min"},getFormattedDistance(e){return e<1e3?e+" m":(e/1e3).toFixed(2)+" km"},onRouteFetched(e){this.routeDuration=null,this.routeDistance=null,e&&e.length>0&&(this.routeDuration=e[0].duration,this.routeDistance=e[0].distance)},onWaypointChange(e){this.waypoints=e},onLinkTypeSelect(e){console.debug("[osm] selected link type",e),this.selectedRoutingLinkTypeId=e?.id??null},onMapSubmit(){const e=this.currentCenter.lat,i=this.currentCenter.lon,o=this.currentZoom,b=this.currentPitch,a=this.currentBearing?parseFloat(this.currentBearing.toFixed(2)):this.currentBearing,n=this.currentMapStyle,h=this.currentMapTerrain?"1":"",f=this.currentMapGlobe?"1":"",m=this.selectedRoutingLinkTypeId;P({lat:e,lon:i,zoom:o,pitch:b,bearing:a,mapStyle:n,terrain:h,globe:f,routingLinkType:m}),this.$el.dispatchEvent(new CustomEvent("submit",{detail:this.currentLink,bubbles:!0}))},onMapStateChange(e){e.centerLat!==void 0&&e.centerLng!==void 0&&(this.currentCenter={lat:parseFloat(e.centerLat.toFixed(6)),lon:parseFloat(e.centerLng.toFixed(6))}),e.zoom!==void 0&&(this.currentZoom=Math.floor(e.zoom)),e.pitch!==void 0&&(this.currentPitch=e.pitch),e.bearing!==void 0&&(this.currentBearing=e.bearing),e.mapStyle!==void 0&&(this.currentMapStyle=e.mapStyle),[!0,!1].includes(e.terrain)&&(this.currentMapTerrain=e.terrain),[!0,!1].includes(e.globe)&&(this.currentMapGlobe=e.globe)}}},q={class:"direction-picker-content"},J={class:"header"},K={key:0},Q={key:1,class:"route--info"},X=["title"],Y=["title"],tt={class:"footer"},et={for:"extension-select"};function it(e,i,o,b,a,n){const h=l("RoutingProfilePicker"),f=l("HelpCircleOutlineIcon"),m=l("NcButton"),D=l("DirectionsPlugin"),w=l("MaplibreMap"),L=l("NcSelect"),_=l("ArrowRightIcon");return p(),d("div",q,[r("h2",null,c(e.t("integration_openstreetmap","Map directions (by OSRM)")),1),r("div",J,[s(h,{modelValue:a.selectedProfile,"onUpdate:modelValue":i[0]||(i[0]=M=>a.selectedProfile=M),class:"profile-select"},null,8,["modelValue"]),n.hint?(p(),d("div",K,c(n.hint),1)):y("",!0),n.formattedDistance&&n.formattedDuration?(p(),d("div",Q,[r("span",{title:a.routeDistance},c(e.t("integration_openstreetmap","Distance: {distance}",{distance:n.formattedDistance})),9,X),i[1]||(i[1]=S(" | ",-1)),r("span",{title:a.routeDuration},c(e.t("integration_openstreetmap","Duration: {duration}",{duration:n.formattedDuration})),9,Y)])):y("",!0),s(m,{title:a.helpText,variant:"tertiary"},{icon:g(()=>[s(f)]),_:1},8,["title"])]),a.showMap?(p(),R(w,{key:0,class:"direction-map",center:n.lastCenter,zoom:a.lastMapState?.zoom,pitch:a.lastMapState?.pitch,bearing:a.lastMapState?.bearing,"map-style":a.lastMapState?.mapStyle,"use-terrain":!!a.lastMapState?.terrain,"use-globe":!!a.lastMapState?.globe,"all-move-events":!0,onMapStateChange:n.onMapStateChange},{default:g(({map:M})=>[s(D,{map:M,profile:n.selectedProfileId,onWaypointChange:n.onWaypointChange,onRouteFetch:n.onRouteFetched},null,8,["map","profile","onWaypointChange","onRouteFetch"])]),_:1},8,["center","zoom","pitch","bearing","map-style","use-terrain","use-globe","onMapStateChange"])):y("",!0),r("div",tt,[r("label",et,c(e.t("integration_openstreetmap","Link type")),1),s(L,{class:"type-select","model-value":n.selectedLinkType,options:a.linkTypesArray,"aria-label-combobox":e.t("integration_openstreetmap","Link type"),placeholder:e.t("integration_openstreetmap","Link type"),"input-id":"extension-select","onUpdate:modelValue":n.onLinkTypeSelect},null,8,["model-value","options","aria-label-combobox","placeholder","onUpdate:modelValue"]),i[2]||(i[2]=r("div",{class:"spacer"},null,-1)),s(m,{class:"submit-button",variant:"primary",disabled:n.currentLink===null,onClick:n.onMapSubmit},{icon:g(()=>[s(_)]),default:g(()=>[S(c(e.t("integration_openstreetmap","Generate direction link"))+" ",1)]),_:1},8,["disabled","onClick"])])])}const gt=v(j,[["render",it],["__scopeId","data-v-78ff1a7a"]]);export{gt as default};
//# sourceMappingURL=DirectionCustomPickerElement-C7D4Zt3G.chunk.mjs.map
