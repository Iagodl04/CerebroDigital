(function(){"use strict";try{if(typeof document<"u"){var e=document.createElement("style");e.appendChild(document.createTextNode(".route-reference[data-v-f4cf6864]{width:100%;white-space:normal}.route-reference .route[data-v-f4cf6864]{width:100%;display:flex;flex-direction:column;position:relative}.route-reference .route .header[data-v-f4cf6864]{margin:4px}.route-reference .route--link[data-v-f4cf6864]{padding:10px}.route-reference .route--link[data-v-f4cf6864]:hover{color:#58a6ff!important}.route-reference .route--info[data-v-f4cf6864]{display:flex;align-items:center;gap:10px}.route-reference .route--info .profile[data-v-f4cf6864]{display:flex;align-items:center;gap:4px}.route-reference .route--info .profile-select[data-v-f4cf6864]{margin:0!important;width:200px!important;min-width:170px!important}.route-reference .route--steps[data-v-f4cf6864]{display:flex;flex-wrap:wrap;gap:4px}.route-reference .route--steps .step[data-v-f4cf6864]{display:flex;gap:4px}.route-reference .route--map[data-v-f4cf6864]{width:100%;height:350px}")),document.head.appendChild(e)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();
import{_ as f}from"./index-B-L25m6y.chunk.mjs";import{c as n,o,a as y,b,t as h,m as C,v as w,r as p,d as M,F as x,x as v,e as d,w as L,p as I,j as S}from"./runtime-core.esm-bundler-CsAAUxo4.chunk.mjs";import{N}from"./Close-D6ngJ4t9-B_k1rgzA.chunk.mjs";import{M as $}from"./MaplibreMap-YzUp5Hnt.chunk.mjs";import{_ as A,R as T,m as Z}from"./index-Bmir7tVa.chunk.mjs";import{m as E,a as G,b as g}from"./mapUtils-m7e-c8Iy.chunk.mjs";import{_ as q}from"./VMarker-CWNB22yj.chunk.mjs";import{a as U}from"./index-hZPKu-D6-Doz9a7UC.chunk.mjs";import"./index-BH5XFfaS.chunk.mjs";import"./legacy-DcjXBL_t-_k54Q3Kp.chunk.mjs";import"./index-DZI6LgVG.chunk.mjs";import"./NcSelect-BUPzYWtk-DxeaHCy0.chunk.mjs";import"./vue.runtime.esm-bundler-XT-a1Su5.chunk.mjs";const J={name:"CloseIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},K=["aria-hidden","aria-label"],Q=["fill","width","height"],X={d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"},Y={key:0};function ee(e,r,i,s,a,l){return o(),n("span",C(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon close-icon",role:"img",onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[y("path",X,[i.title?(o(),n("title",Y,h(i.title),1)):b("",!0)])],8,Q))],16,K)}const te=f(J,[["render",ee]]),ie={name:"PencilIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},re=["aria-hidden","aria-label"],oe=["fill","width","height"],le={d:"M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z"},ae={key:0};function ne(e,r,i,s,a,l){return o(),n("span",C(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon pencil-icon",role:"img",onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[y("path",le,[i.title?(o(),n("title",ae,h(i.title),1)):b("",!0)])],8,oe))],16,re)}const se=f(ie,[["render",ne]]),ce={name:"ClipboardCheckOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},pe=["aria-hidden","aria-label"],de=["fill","width","height"],he={d:"M19,3H14.82C14.4,1.84 13.3,1 12,1C10.7,1 9.6,1.84 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7M7.5,13.5L9,12L11,14L15.5,9.5L17,11L11,17L7.5,13.5Z"},ue={key:0};function ye(e,r,i,s,a,l){return o(),n("span",C(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon clipboard-check-outline-icon",role:"img",onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[y("path",he,[i.title?(o(),n("title",ue,h(i.title),1)):b("",!0)])],8,de))],16,pe)}const me=f(ce,[["render",ye]]),ge={name:"ClipboardTextOutlineIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},fe=["aria-hidden","aria-label"],be=["fill","width","height"],Ce={d:"M19,3H14.82C14.25,1.44 12.53,0.64 11,1.2C10.14,1.5 9.5,2.16 9.18,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M12,3A1,1 0 0,1 13,4A1,1 0 0,1 12,5A1,1 0 0,1 11,4A1,1 0 0,1 12,3M7,7H17V5H19V19H5V5H7V7M17,11H7V9H17V11M15,15H7V13H15V15Z"},ke={key:0};function Le(e,r,i,s,a,l){return o(),n("span",C(e.$attrs,{"aria-hidden":i.title?null:"true","aria-label":i.title,class:"material-design-icon clipboard-text-outline-icon",role:"img",onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,class:"material-design-icon__svg",width:i.size,height:i.size,viewBox:"0 0 24 24"},[y("path",Ce,[i.title?(o(),n("title",ke,h(i.title),1)):b("",!0)])],8,be))],16,fe)}const xe=f(ge,[["render",Le]]),ve={name:"MarkerIcon",props:{title:{type:String,default:""},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Ie=["aria-hidden","aria-label"],we=["fill","width","height"];function je(e,r,i,s,a,l){return o(),n("span",C({"aria-hidden":!i.title,"aria-label":i.title,class:"material-design-icon marker-icon",role:"img"},e.$attrs,{onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,width:i.size,height:i.size,"enable-background":"new 0 0 27 41",version:"1.1",viewBox:"0 0 27 41","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"},[...r[1]||(r[1]=[w('<g fill-rule="nonzero"><g transform="translate(3.0, 29.0)" fill="#000000"><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="9.5" ry="4.77275007"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="8.5" ry="4.29549936"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="7.5" ry="3.81822308"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="6.5" ry="3.34094679"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="5.5" ry="2.86367051"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="4.5" ry="2.38636864"></ellipse></g><g fill="#3FB1CE"><path d="M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"></path></g><g opacity="0.25" fill="#000000"><path d="M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"></path></g><g transform="translate(6.0, 7.0)" fill="#FFFFFF"></g><g transform="translate(8.0, 8.0)"><circle fill="#000000" opacity="0.25" cx="5.5" cy="5.5" r="5.4999962"></circle><circle fill="#FFFFFF" cx="5.5" cy="5.5" r="5.4999962"></circle></g></g>',1)])],8,we))],16,Ie)}const Me=f(ve,[["render",je]]),Fe={name:"MarkerRedIcon",props:{title:{type:String,default:""},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},Oe=["aria-hidden","aria-label"],Re=["fill","width","height"];function Pe(e,r,i,s,a,l){return o(),n("span",C({"aria-hidden":!i.title,"aria-label":i.title,class:"material-design-icon marker-red-icon",role:"img"},e.$attrs,{onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,width:i.size,height:i.size,"enable-background":"new 0 0 27 41",version:"1.1",viewBox:"0 0 27 41","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"},[...r[1]||(r[1]=[w('<g fill-rule="nonzero"><g transform="translate(3.0, 29.0)" fill="#000000"><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="9.5" ry="4.77275007"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="8.5" ry="4.29549936"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="7.5" ry="3.81822308"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="6.5" ry="3.34094679"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="5.5" ry="2.86367051"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="4.5" ry="2.38636864"></ellipse></g><g fill="red"><path d="M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"></path></g><g opacity="0.25" fill="#000000"><path d="M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"></path></g><g transform="translate(6.0, 7.0)" fill="#FFFFFF"></g><g transform="translate(8.0, 8.0)"><circle fill="#000000" opacity="0.25" cx="5.5" cy="5.5" r="5.4999962"></circle><circle fill="#FFFFFF" cx="5.5" cy="5.5" r="5.4999962"></circle></g></g>',1)])],8,Re))],16,Oe)}const ze=f(Fe,[["render",Pe]]),Be={name:"MarkerGreenIcon",props:{title:{type:String,default:""},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},_e=["aria-hidden","aria-label"],We=["fill","width","height"];function Ve(e,r,i,s,a,l){return o(),n("span",C({"aria-hidden":!i.title,"aria-label":i.title,class:"material-design-icon marker-green-icon",role:"img"},e.$attrs,{onClick:r[0]||(r[0]=c=>e.$emit("click",c))}),[(o(),n("svg",{fill:i.fillColor,width:i.size,height:i.size,"enable-background":"new 0 0 27 41",version:"1.1",viewBox:"0 0 27 41","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"},[...r[1]||(r[1]=[w('<g fill-rule="nonzero"><g transform="translate(3.0, 29.0)" fill="#000000"><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="10.5" ry="5.25002273"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="9.5" ry="4.77275007"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="8.5" ry="4.29549936"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="7.5" ry="3.81822308"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="6.5" ry="3.34094679"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="5.5" ry="2.86367051"></ellipse><ellipse opacity="0.04" cx="10.5" cy="5.80029008" rx="4.5" ry="2.38636864"></ellipse></g><g fill="lightgreen"><path d="M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"></path></g><g opacity="0.25" fill="#000000"><path d="M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"></path></g><g transform="translate(6.0, 7.0)" fill="#FFFFFF"></g><g transform="translate(8.0, 8.0)"><circle fill="#000000" opacity="0.25" cx="5.5" cy="5.5" r="5.4999962"></circle><circle fill="#FFFFFF" cx="5.5" cy="5.5" r="5.4999962"></circle></g></g>',1)])],8,We))],16,_e)}const De=f(Be,[["render",Ve]]),He={name:"LinestringCollection",components:{},props:{layerId:{type:String,default:"line"},geojson:{type:Object,required:!0},map:{type:Object,required:!0},lineWidth:{type:Number,default:5},borderColor:{type:String,default:"black"},border:{type:Boolean,default:!0},opacity:{type:Number,default:1}},emits:["click"],data(){return{ready:!1,popup:null}},computed:{borderLayerId(){return this.layerId+"-border"},invisibleBorderLayerId(){return this.layerId+"-invisible-border"},color(){return this.geojson.color??"#0693e3"}},watch:{ready(e){e&&this.listenToEvents()},color(e){this.map.getLayer(this.layerId)&&this.map.setPaintProperty(this.layerId,"line-color",e)},geojson(){console.debug("[osm] geojson has changed"),this.remove(),this.init()},border(e){e?this.drawBorder():this.removeBorder()},opacity(){console.debug("[osm] line opacity has changed",this.layerId),this.map.getLayer(this.layerId)&&this.map.setPaintProperty(this.layerId,"line-opacity",this.opacity),this.map.getLayer(this.borderLayerId)&&this.map.setPaintProperty(this.borderLayerId,"line-opacity",this.opacity)},lineWidth(){this.setNormalLineWidth()}},mounted(){console.debug("[osm] line mounted",this.layerId),this.init()},unmounted(){console.debug("[osm] destroy line",this.layerId),this.releaseEvents(),this.remove()},methods:{bringToTop(){console.debug("[osm] bring line to top",this.layerId),this.map.getLayer(this.borderLayerId)&&this.map.moveLayer(this.borderLayerId),this.map.getLayer(this.layerId)&&this.map.moveLayer(this.layerId)},onMouseEnter(e){this.map.getCanvas().style.cursor="pointer",this.map.getLayer(this.layerId)&&this.map.setPaintProperty(this.layerId,"line-width",this.lineWidth*1.7),this.map.getLayer(this.borderLayerId)&&(this.map.setPaintProperty(this.borderLayerId,"line-width",this.lineWidth*.3*1.7),this.map.setPaintProperty(this.borderLayerId,"line-gap-width",this.lineWidth*1.7)),this.geojson.popupContent&&this.showPopup(e.lngLat,!1)},onMouseLeave(){this.map.getCanvas().style.cursor="",this.setNormalLineWidth(),this.popup&&(this.popup.remove(),this.popup=null)},onClick(){this.$emit("click")},showPopup(e){this.popup&&this.popup.remove();const r='<div style="border-color: '+this.color+';">'+this.geojson.popupContent.replace(`
`,"<br>")+"</div>",i=new E.Popup({closeButton:!1,closeOnClick:!0,closeOnMove:!0}).trackPointer().setHTML(r).addTo(this.map);this.popup=i},setNormalLineWidth(){this.map.getLayer(this.layerId)&&this.map.setPaintProperty(this.layerId,"line-width",this.lineWidth),this.map.getLayer(this.borderLayerId)&&(this.map.setPaintProperty(this.borderLayerId,"line-width",this.lineWidth*.3),this.map.setPaintProperty(this.borderLayerId,"line-gap-width",this.lineWidth))},listenToEvents(){this.map.on("click",this.invisibleBorderLayerId,this.onClick),this.map.on("mouseenter",this.invisibleBorderLayerId,this.onMouseEnter),this.map.on("mouseleave",this.invisibleBorderLayerId,this.onMouseLeave)},releaseEvents(){this.map.off("click",this.invisibleBorderLayerId,this.onClick),this.map.off("mouseenter",this.invisibleBorderLayerId,this.onMouseEnter),this.map.off("mouseleave",this.invisibleBorderLayerId,this.onMouseLeave)},remove(){this.map.getLayer(this.invisibleBorderLayerId)&&this.map.removeLayer(this.invisibleBorderLayerId),this.removeBorder(),this.removeLine(),this.map.getSource(this.layerId)&&this.map.removeSource(this.layerId)},removeLine(){this.map.getLayer(this.layerId)&&this.map.removeLayer(this.layerId)},removeBorder(){this.map.getLayer(this.borderLayerId)&&this.map.removeLayer(this.borderLayerId)},drawBorder(){this.map.addLayer({type:"line",source:this.layerId,id:this.borderLayerId,paint:{"line-color":this.borderColor,"line-width":this.lineWidth*.3,"line-opacity":this.opacity,"line-gap-width":this.lineWidth},layout:{"line-cap":"round","line-join":"round"},filter:["!=","$type","Point"]})},drawLine(){this.map.addLayer({type:"line",source:this.layerId,id:this.layerId,paint:{"line-color":this.color,"line-width":this.lineWidth,"line-opacity":this.opacity},layout:{"line-cap":"round","line-join":"round"},filter:["!=","$type","Point"]})},init(){this.map.addSource(this.layerId,{type:"geojson",lineMetrics:!0,data:this.geojson}),this.map.addLayer({type:"line",source:this.layerId,id:this.invisibleBorderLayerId,paint:{"line-opacity":0,"line-width":Math.max(this.lineWidth,30)},layout:{"line-cap":"round","line-join":"round"}}),this.border&&this.drawBorder(),this.drawLine(),this.ready=!0}},render(e){return null}},Se={name:"MaplibreRouteReferenceWidget",components:{VMarker:q,RoutingProfilePicker:T,NcButton:N,DirectionsPlugin:A,MarkerGreenIcon:De,MarkerRedIcon:ze,MarkerIcon:Me,MaplibreMap:$,LinestringCollection:He,PencilIcon:se,CloseIcon:te,ClipboardCheckOutlineIcon:me,ClipboardTextOutlineIcon:xe},props:{richObjectType:{type:String,default:""},richObject:{type:Object,default:null},accessible:{type:Boolean,default:!0}},data(){return{selectedRouteIndex:0,editing:!1,editingWaypoints:[],editingRoute:null,copied:!1,selectedRoutingProfile:g[this.richObject.profile]??g.car}},computed:{routeGeojsons(){return this.richObject.routes.map(e=>e.geojson)},selectedRoute(){return this.editing?this.editingRoute:this.richObject.routes[this.selectedRouteIndex]},formattedDuration(){return this.selectedRoute?.duration?this.getFormattedDuration(this.selectedRoute):null},formattedDistance(){return this.selectedRoute?.distance?this.getFormattedDistance(this.selectedRoute):null},profileIcon(){return this.richObject.profile?g[this.richObject.profile]?g[this.richObject.profile].icon:g.car.icon:null},profileDisplayName(){return this.richObject.profile?g[this.richObject.profile]?g[this.richObject.profile].label:g.car.label:null},bbox(){if(this.mapCenter||this.richObject.routes.length===0)return;const e=this.richObject.routes[this.selectedRouteIndex],r=e.geojson.features.reduce((s,a)=>[...s,...a.geometry.coordinates.map(l=>l[1])],[]),i=e.geojson.features.reduce((s,a)=>[...s,...a.geometry.coordinates.map(l=>l[0])],[]);return{north:r.reduce((s,a)=>Math.max(s,a)),south:r.reduce((s,a)=>Math.min(s,a)),east:i.reduce((s,a)=>Math.max(s,a)),west:i.reduce((s,a)=>Math.min(s,a))}},zoom(){return this.richObject.zoom},pitch(){return this.richObject.pitch},bearing(){return this.richObject.bearing},style(){return this.richObject.style??void 0},useTerrain(){return this.richObject.terrain??void 0},useGlobe(){return this.richObject.globe??void 0},mapCenter(){return this.richObject.map_center},currentRoutingLink(){if(this.editing)return G(this.editingWaypoints,this.selectedRoutingProfile,this.richObject.type)}},mounted(){this.updateRouteOpacities(),this.setRoutesPopupContent(),console.debug("[osm] routing mounted",this.richObject)},methods:{async copyRoutingLink(){console.debug("[osm] copy link",this.currentRoutingLink);try{await navigator.clipboard.writeText(this.currentRoutingLink),this.copied=!0,setTimeout(()=>{this.copied=!1},5e3)}catch(e){console.error(e),U(t("integration_openstreetmap","Link could not be copied to clipboard"))}},onWaypointChange(e){this.editingWaypoints=e},onRouteFetched(e){e&&e.length>0?this.editingRoute=e[0]:this.editingRoute=null},getFormattedDuration(e){const r=Z.duration(e.duration,"seconds");return e.duration<3600?r.humanize():e.duration<3600*24?r.hours()+" h "+r.minutes()+" min":r.days()+" d "+r.hours()+" h "+r.minutes()+" min"},getFormattedDistance(e){return e.distance<1e3?e.distance+" m":(e.distance/1e3).toFixed(2)+" km"},onRouteClicked(e){this.selectedRouteIndex=e,this.updateRouteOpacities()},updateRouteOpacities(){this.routeGeojsons.forEach(e=>{e.opacity=.3}),this.routeGeojsons[this.selectedRouteIndex].opacity=1},setRoutesPopupContent(){this.richObject.routes.forEach(e=>{let r="";e.distance&&(r+=`
`+t("integration_openstreetmap","Distance: {distance}",{distance:this.getFormattedDistance(e)})),e.duration&&(r+=`
`+t("integration_openstreetmap","Duration: {duration}",{duration:this.getFormattedDuration(e)})),e.geojson.popupContent=r.trim()})}}},Ne={class:"route-reference"},$e={class:"route"},Ae=["href"],Te={class:"route--name"},Ze={class:"header"},Ee={class:"route--steps"},Ge={class:"route--info"},qe={key:1,class:"profile"},Ue=["title"],Je={key:4},Ke=["title"],Qe={key:6};function Xe(e,r,i,s,a,l){const c=p("MarkerGreenIcon"),F=p("MarkerRedIcon"),O=p("MarkerIcon"),R=p("CloseIcon"),P=p("PencilIcon"),j=p("NcButton"),z=p("ClipboardCheckOutlineIcon"),B=p("ClipboardTextOutlineIcon"),_=p("RoutingProfilePicker"),W=p("DirectionsPlugin"),V=p("LinestringCollection"),D=p("VMarker"),H=p("MaplibreMap");return o(),n("div",Ne,[y("div",$e,[i.richObject.display_name?(o(),n("a",{key:0,class:"route--link",href:i.richObject.url,target:"_blank"},[y("strong",Te,h(i.richObject.display_name),1)],8,Ae)):b("",!0),y("div",Ze,[y("div",Ee,[(o(!0),n(x,null,v(i.richObject.waypoints,(m,u)=>(o(),n("span",{key:"step-"+u,class:"step"},[u===0?(o(),d(c,{key:0})):u===i.richObject.waypoints.length-1?(o(),d(F,{key:1})):(o(),d(O,{key:2})),y("span",null,h(m.name||m.location.join(", ")),1)]))),128))]),y("div",Ge,[M(j,{onClick:r[0]||(r[0]=m=>a.editing=!a.editing)},{icon:L(()=>[a.editing?(o(),d(R,{key:0})):(o(),d(P,{key:1}))]),default:L(()=>[I(h(a.editing?e.t("integration_openstreetmap","Cancel edition"):e.t("integration_openstreetmap","Edit route"))+" ",1)]),_:1}),a.editing&&l.currentRoutingLink?(o(),d(j,{key:0,onClick:l.copyRoutingLink},{icon:L(()=>[a.copied?(o(),d(z,{key:0,"fill-color":"green"})):(o(),d(B,{key:1}))]),default:L(()=>[I(h(e.t("integration_openstreetmap","Copy direction link"))+" ",1)]),_:1},8,["onClick"])):b("",!0),!a.editing&&l.profileDisplayName?(o(),n("span",qe,[(o(),d(S(l.profileIcon))),I(" "+h(l.profileDisplayName),1)])):(o(),d(_,{key:2,modelValue:a.selectedRoutingProfile,"onUpdate:modelValue":r[1]||(r[1]=m=>a.selectedRoutingProfile=m),class:"profile-select"},null,8,["modelValue"])),l.formattedDistance?(o(),n("span",{key:3,title:i.richObject.distance},h(e.t("integration_openstreetmap","Distance: {distance}",{distance:l.formattedDistance})),9,Ue)):(o(),n("span",Je,h(e.t("integration_openstreetmap","Unknown distance")),1)),l.formattedDuration?(o(),n("span",{key:5,title:i.richObject.duration},h(e.t("integration_openstreetmap","Duration: {duration}",{duration:l.formattedDuration})),9,Ke)):(o(),n("span",Qe,h(e.t("integration_openstreetmap","Unknown duration")),1))])]),M(H,{class:"route--map",scrolling:"no",bbox:l.bbox,center:l.mapCenter,zoom:l.zoom,pitch:l.pitch,bearing:l.bearing,"map-style":l.style,"use-terrain":l.useTerrain,"use-globe":l.useGlobe,onLineClick:l.onRouteClicked},{default:L(({map:m})=>[a.editing?(o(),d(W,{key:0,map:m,profile:a.selectedRoutingProfile?.id??void 0,"initial-waypoints":i.richObject.queryPoints.map(u=>[u[1],u[0]]),onWaypointChange:l.onWaypointChange,onRouteFetch:l.onRouteFetched},null,8,["map","profile","initial-waypoints","onWaypointChange","onRouteFetch"])):b("",!0),(o(!0),n(x,null,v(a.editing?[]:l.routeGeojsons,(u,k)=>(o(),d(V,{key:"line-"+k,"layer-id":"line-"+k,geojson:u,opacity:u.opacity,map:m,onClick:Ye=>l.onRouteClicked(k)},null,8,["layer-id","geojson","opacity","map","onClick"]))),128)),(o(!0),n(x,null,v(a.editing?[]:i.richObject.waypoints,(u,k)=>(o(),d(D,{key:"marker-"+k,map:m,color:u.color,"lng-lat":u.location},null,8,["map","color","lng-lat"]))),128))]),_:1},8,["bbox","center","zoom","pitch","bearing","map-style","use-terrain","use-globe","onLineClick"])])])}const ut=f(Se,[["render",Xe],["__scopeId","data-v-f4cf6864"]]);export{ut as default};
//# sourceMappingURL=MaplibreRouteReferenceWidget-DsoZlZIO.chunk.mjs.map
